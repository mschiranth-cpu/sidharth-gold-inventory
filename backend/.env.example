# ============================================
# GOLD INVENTORY SYSTEM - BACKEND CONFIGURATION
# ============================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control!
# 
# SECURITY WARNING: 
# - Generate unique, strong secrets for production
# - Use different values for dev/staging/prod
# - Rotate secrets periodically
# ============================================

# ============================================
# SERVER CONFIGURATION
# ============================================
NODE_ENV=development
PORT=3000
HOST=localhost

# ============================================
# DATABASE CONFIGURATION (PostgreSQL + Prisma)
# ============================================
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
DATABASE_URL="postgresql://postgres:your_password@localhost:5432/gold_inventory_db?schema=public"

# Connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_TIMEOUT=30000

# ============================================
# AUTHENTICATION & SECURITY
# ============================================
# JWT Configuration
# IMPORTANT: Generate strong random strings (min 32 chars)
# Use: openssl rand -hex 32
JWT_SECRET=CHANGE_ME_generate_32_char_random_string_here
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=CHANGE_ME_different_32_char_random_string
JWT_REFRESH_EXPIRES_IN=7d

# Password hashing
BCRYPT_SALT_ROUNDS=12

# Password requirements
PASSWORD_MIN_LENGTH=8

# ============================================
# CORS CONFIGURATION
# ============================================
# Comma-separated list of allowed origins (whitelist)
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:4173
CORS_CREDENTIALS=true

# ============================================
# CSRF PROTECTION
# ============================================
CSRF_ENABLED=true
# Generate unique secret: openssl rand -hex 32
CSRF_SECRET=CHANGE_ME_csrf_secret_32_chars_minimum

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=1000
RATE_LIMIT_AUTH_WINDOW_MS=60000
RATE_LIMIT_AUTH_MAX=20

# ============================================
# BRUTE FORCE PROTECTION
# ============================================
BRUTE_FORCE_ENABLED=true
LOGIN_MAX_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=900000
LOGIN_ATTEMPT_WINDOW=900000
# Comma-separated whitelist IPs (skip brute force check)
BRUTE_FORCE_WHITELIST_IPS=

# ============================================
# DATA ENCRYPTION
# ============================================
ENCRYPTION_ENABLED=true
# IMPORTANT: Generate a 32-byte (64 hex char) key
# Use: openssl rand -hex 32
ENCRYPTION_KEY=CHANGE_ME_64_hex_characters_encryption_key_here

# ============================================
# AUDIT LOGGING
# ============================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_STORAGE=database
AUDIT_LOG_PATH=./logs/audit.log
AUDIT_LOG_RETENTION_DAYS=90

# ============================================
# API KEYS (for external integrations)
# ============================================
API_KEYS_ENABLED=false

# ============================================
# TWO-FACTOR AUTHENTICATION
# ============================================
TWO_FACTOR_ENABLED=false
TWO_FACTOR_ISSUER=Gold Inventory System

# ============================================
# REQUEST SECURITY
# ============================================
REQUEST_TIMEOUT=30000
SLOW_REQUEST_THRESHOLD=5000

# ============================================
# FILE UPLOAD SECURITY
# ============================================
MAX_FILE_SIZE=10485760
UPLOAD_DIR=./uploads
TEMP_UPLOAD_DIR=./uploads/temp
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf

# Malware scanning (requires ClamAV)
MALWARE_SCAN_ENABLED=false
CLAMAV_HOST=localhost
CLAMAV_PORT=3310
RATE_LIMIT_AUTH_MAX_REQUESTS=5
RATE_LIMIT_UPLOAD_WINDOW_MS=3600000
RATE_LIMIT_UPLOAD_MAX_REQUESTS=10

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=debug
LOG_FORMAT=combined
LOG_DIR=./logs

# ============================================
# REDIS CONFIGURATION (for caching/sessions/rate-limiting)
# ============================================
REDIS_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=gold_inv:
REDIS_TLS=false

# Cache TTL settings (in seconds)
REDIS_TTL_DEFAULT=300
REDIS_TTL_SESSION=86400
REDIS_TTL_DASHBOARD=300
REDIS_TTL_ORDERS_LIST=60

# ============================================
# EMAIL CONFIGURATION (optional)
# ============================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@example.com
SMTP_PASSWORD=your-email-password
EMAIL_FROM="Gold Inventory <noreply@example.com>"

# ============================================
# GOLD PRICING API (optional)
# ============================================
GOLD_PRICE_API_URL=https://api.example.com/gold-price
GOLD_PRICE_API_KEY=your-api-key

# ============================================
# MONITORING & ERROR TRACKING
# ============================================
# Sentry (error tracking)
SENTRY_ENABLED=false
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Performance monitoring
PERFORMANCE_SLOW_REQUEST_THRESHOLD_MS=1000
NEW_RELIC_LICENSE_KEY=

# ============================================
# COMPRESSION SETTINGS
# ============================================
COMPRESSION_ENABLED=true
COMPRESSION_THRESHOLD=1024
COMPRESSION_LEVEL=6

# ============================================
# IMAGE OPTIMIZATION
# ============================================
IMAGE_MAX_WIDTH=1920
IMAGE_MAX_HEIGHT=1080
IMAGE_QUALITY=80
IMAGE_ENABLE_WEBP=true

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_SMS_NOTIFICATIONS=false
FEATURE_AUDIT_LOGGING=true

# ============================================
# SECRETS MANAGEMENT
# ============================================
# For production, consider using:
# - AWS Secrets Manager
# - HashiCorp Vault
# - Azure Key Vault
# - Google Secret Manager
# 
# Environment-specific secrets:
# - Development: Use .env.development
# - Staging: Use .env.staging  
# - Production: Use .env.production or secrets manager
#
# Secret rotation schedule:
# - JWT secrets: Every 90 days
# - Encryption keys: Every 180 days
# - API keys: Every 90 days
# - Database passwords: Every 90 days
